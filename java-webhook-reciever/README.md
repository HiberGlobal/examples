# Example java server receiving hiber webhook calls

Run `test.sh` to test it with a predefined event (test.json)

For real events, use `run.sh` and expose the port to the internet. Then set up a webhook pointing to that ip and port.

### Successful usage example:
- set up the server and exposed it
- created a webhook "woutest"
- created a second webhook "test webhook 2"
  - this triggered two messages, one to "woutest" and one to "test webhook 2"

```
Server starting at process 11520
Press enter to restart, ctrl-c to stop
Received body (hex):
7B0A2020227075626C697368657243726561746564223A207B0A20202020226F7267616E697A6174696F6E223A20226869626572222C0A202020202263726561746564223A207B0A202020202020226964223A202231222C0A202020202020226465736372697074696F6E223A2022776F7574657374222C0A2020202020202264617461223A207B0A20202020202020202275726C223A2022687474703A2F2F6C6F63616C686F73743A38303730222C0A202020202020202022636F6E74656E7454797065223A20224A534F4E222C0A20202020202020202268747470223A207B0A2020202020202020202022736563726574223A2022746869732069732061207465737420666F722074686520736563726574220A20202020202020207D0A2020202020207D2C0A2020202020202266696C74657273223A207B0A2020202020202020226576656E745479706573223A207B0A2020202020202020202022696E636C756465223A205B22555345525F4144444544222C20225055424C49534845525F4641494C4544222C20225055424C49534845525F43524541544544222C20224D4F44454D5F5452414E534645525F4E4F545F5245434549564544222C20224D4F44454D5F414354495641544544222C20224D4F44454D5F4D4553534147455F5245434549564544222C20224D4F44454D5F5452414E534645525F52455455524E5F5452414E534645525F53544152544544222C2022544F4B454E5F44454C45544544222C20224C4F524157414E5F4D4F44454D535F44495341424C4544222C20224D4F44454D5F4D4553534147455F43414E4E4F545F42455F504152534544222C2022544F4B454E5F45585049524544222C20225055424C49534845525F55504441544544222C20224D4F44454D5F4C4F434154494F4E5F55504441544544222C20224D4F44454D5F434C41494D4544222C2022555345525F4143434553535F52455155455354222C20225055424C49534845525F44454C45544544222C20224D4F44454D5F5452414E534645525F53544152544544222C20224D4F44454D5F5354414C45222C20224D4F44454D5F5452414E534645525F5245434549564544222C20224D4F44454D5F5452414E534645525F43414E43454C4C4544222C2022555345525F52454D4F564544222C20224C4F524157414E5F4D4F44454D535F454E41424C4544222C20224D4F44454D5F4D4553534147455F53455155454E43455F534B4950222C20224D4F44454D5F4D4553534147455F44454C41594544222C20224C4F524157414E5F4D4553534147455F464F52574152445F4641494C4544222C20224F5247414E495A4154494F4E5F55504441544544222C20224C4F524157414E5F434F4E46494755524154494F4E5F55504441544544222C2022544F4B454E5F4558504952595F5741524E494E47222C2022544F4B454E5F43524541544544225D0A20202020202020207D2C0A2020202020202020226D6F64656D4E756D62657273223A207B0A20202020202020207D2C0A20202020202020202274616773223A207B0A20202020202020207D0A2020202020207D0A202020207D2C0A20202020227469746C65223A20225075626C6973686572203120686173206265656E20637265617465642E222C0A20202020226465736372697074696F6E223A2022436865636B20746865207075626C697368657273206C69737420666F722064657461696C73206F6E207075626C697368657220312E222C0A202020202274696D65223A207B0A2020202020202274696D657374616D70223A2022323031392D30352D31365431333A34343A34392E3333325A222C0A202020202020227465787475616C223A2022323031392D30352D31365431333A34343A34392E3333325A220A202020207D0A20207D0A7D

Received body (utf8):
{
  "publisherCreated": {
    "organization": "hiber",
    "created": {
      "id": "1",
      "description": "woutest",
      "data": {
        "url": "http://localhost:8070",
        "contentType": "JSON",
        "http": {
          "secret": "this is a test for the secret"
        }
      },
      "filters": {
        "eventTypes": {
          "include": ["USER_ADDED", "PUBLISHER_FAILED", "PUBLISHER_CREATED", "MODEM_TRANSFER_NOT_RECEIVED", "MODEM_ACTIVATED", "MODEM_MESSAGE_RECEIVED", "MODEM_TRANSFER_RETURN_TRANSFER_STARTED", "TOKEN_DELETED", "LORAWAN_MODEMS_DISABLED", "MODEM_MESSAGE_CANNOT_BE_PARSED", "TOKEN_EXPIRED", "PUBLISHER_UPDATED", "MODEM_LOCATION_UPDATED", "MODEM_CLAIMED", "USER_ACCESS_REQUEST", "PUBLISHER_DELETED", "MODEM_TRANSFER_STARTED", "MODEM_STALE", "MODEM_TRANSFER_RECEIVED", "MODEM_TRANSFER_CANCELLED", "USER_REMOVED", "LORAWAN_MODEMS_ENABLED", "MODEM_MESSAGE_SEQUENCE_SKIP", "MODEM_MESSAGE_DELAYED", "LORAWAN_MESSAGE_FORWARD_FAILED", "ORGANIZATION_UPDATED", "LORAWAN_CONFIGURATION_UPDATED", "TOKEN_EXPIRY_WARNING", "TOKEN_CREATED"]
        },
        "modemNumbers": {
        },
        "tags": {
        }
      }
    },
    "title": "Publisher 1 has been created.",
    "description": "Check the publishers list for details on publisher 1.",
    "time": {
      "timestamp": "2019-05-16T13:44:49.332Z",
      "textual": "2019-05-16T13:44:49.332Z"
    }
  }
}


Expecting secret (utf8):
this is a test for the secret

Expecting secret (hex) (should be 746869732069732061207465737420666F722074686520736563726574):
746869732069732061207465737420666F722074686520736563726574


Received signature (hex):
416A11CC8836FDF57AD6A29E538A6FFB828882BCC2D2C28697C3A3837B1EF078


Expecting signature (hex):
416A11CC8836FDF57AD6A29E538A6FFB828882BCC2D2C28697C3A3837B1EF078

Signature is correct!
Received body (hex):
7B0A2020227075626C697368657243726561746564223A207B0A20202020226F7267616E697A6174696F6E223A20226869626572222C0A202020202263726561746564223A207B0A202020202020226964223A202232222C0A202020202020226465736372697074696F6E223A20227465737420776562686F6F6B2032222C0A2020202020202264617461223A207B0A20202020202020202275726C223A2022687474703A2F2F6C6F63616C686F73743A38303730222C0A202020202020202022636F6E74656E7454797065223A20224A534F4E222C0A20202020202020202268747470223A207B0A2020202020202020202022736563726574223A2022746869732069732061207465737420666F722074686520736563726574220A20202020202020207D0A2020202020207D2C0A2020202020202266696C74657273223A207B0A2020202020202020226576656E745479706573223A207B0A2020202020202020202022696E636C756465223A205B22555345525F4144444544222C20225055424C49534845525F4641494C4544222C20225055424C49534845525F43524541544544222C20224D4F44454D5F5452414E534645525F4E4F545F5245434549564544222C20224D4F44454D5F4D4553534147455F5245434549564544222C20224D4F44454D5F5452414E534645525F52455455524E5F5452414E534645525F53544152544544222C20224C4F524157414E5F4D4F44454D535F44495341424C4544222C20224D4F44454D5F4D4553534147455F43414E4E4F545F42455F504152534544222C2022544F4B454E5F45585049524544222C20225055424C49534845525F55504441544544222C20224D4F44454D5F4C4F434154494F4E5F55504441544544222C20224D4F44454D5F434C41494D4544222C2022555345525F4143434553535F52455155455354222C20225055424C49534845525F44454C45544544222C20224D4F44454D5F5452414E534645525F53544152544544222C20224D4F44454D5F5354414C45222C20224D4F44454D5F5452414E534645525F5245434549564544222C20224D4F44454D5F5452414E534645525F43414E43454C4C4544222C2022555345525F52454D4F564544222C20224C4F524157414E5F4D4F44454D535F454E41424C4544222C20224D4F44454D5F4D4553534147455F53455155454E43455F534B4950222C20224D4F44454D5F4D4553534147455F44454C41594544222C20224C4F524157414E5F4D4553534147455F464F52574152445F4641494C4544222C20224F5247414E495A4154494F4E5F55504441544544222C20224C4F524157414E5F434F4E46494755524154494F4E5F55504441544544222C2022544F4B454E5F4558504952595F5741524E494E47222C2022544F4B454E5F43524541544544225D0A20202020202020207D2C0A2020202020202020226D6F64656D4E756D62657273223A207B0A20202020202020207D2C0A20202020202020202274616773223A207B0A20202020202020207D0A2020202020207D0A202020207D2C0A20202020227469746C65223A20225075626C6973686572203220686173206265656E20637265617465642E222C0A20202020226465736372697074696F6E223A2022436865636B20746865207075626C697368657273206C69737420666F722064657461696C73206F6E207075626C697368657220322E222C0A202020202274696D65223A207B0A2020202020202274696D657374616D70223A2022323031392D30352D31365431333A34363A34372E3136385A222C0A202020202020227465787475616C223A2022323031392D30352D31365431333A34363A34372E3136385A220A202020207D0A20207D0A7D

Received body (utf8):
{
  "publisherCreated": {
    "organization": "hiber",
    "created": {
      "id": "2",
      "description": "test webhook 2",
      "data": {
        "url": "http://localhost:8070",
        "contentType": "JSON",
        "http": {
          "secret": "this is a test for the secret"
        }
      },
      "filters": {
        "eventTypes": {
          "include": ["USER_ADDED", "PUBLISHER_FAILED", "PUBLISHER_CREATED", "MODEM_TRANSFER_NOT_RECEIVED", "MODEM_MESSAGE_RECEIVED", "MODEM_TRANSFER_RETURN_TRANSFER_STARTED", "LORAWAN_MODEMS_DISABLED", "MODEM_MESSAGE_CANNOT_BE_PARSED", "TOKEN_EXPIRED", "PUBLISHER_UPDATED", "MODEM_LOCATION_UPDATED", "MODEM_CLAIMED", "USER_ACCESS_REQUEST", "PUBLISHER_DELETED", "MODEM_TRANSFER_STARTED", "MODEM_STALE", "MODEM_TRANSFER_RECEIVED", "MODEM_TRANSFER_CANCELLED", "USER_REMOVED", "LORAWAN_MODEMS_ENABLED", "MODEM_MESSAGE_SEQUENCE_SKIP", "MODEM_MESSAGE_DELAYED", "LORAWAN_MESSAGE_FORWARD_FAILED", "ORGANIZATION_UPDATED", "LORAWAN_CONFIGURATION_UPDATED", "TOKEN_EXPIRY_WARNING", "TOKEN_CREATED"]
        },
        "modemNumbers": {
        },
        "tags": {
        }
      }
    },
    "title": "Publisher 2 has been created.",
    "description": "Check the publishers list for details on publisher 2.",
    "time": {
      "timestamp": "2019-05-16T13:46:47.168Z",
      "textual": "2019-05-16T13:46:47.168Z"
    }
  }
}


Expecting secret (utf8):
this is a test for the secret

Expecting secret (hex) (should be 746869732069732061207465737420666F722074686520736563726574):
746869732069732061207465737420666F722074686520736563726574


Received signature (hex):
8BDC5203BBDB019A0F3D71A670026FFF122A129B193851369A09360AE65DE6BF


Expecting signature (hex):
8BDC5203BBDB019A0F3D71A670026FFF122A129B193851369A09360AE65DE6BF
Signature is correct!
Received body (hex):
7B0A2020227075626C697368657243726561746564223A207B0A20202020226F7267616E697A6174696F6E223A20226869626572222C0A202020202263726561746564223A207B0A202020202020226964223A202232222C0A202020202020226465736372697074696F6E223A20227465737420776562686F6F6B2032222C0A2020202020202264617461223A207B0A20202020202020202275726C223A2022687474703A2F2F6C6F63616C686F73743A38303730222C0A202020202020202022636F6E74656E7454797065223A20224A534F4E222C0A20202020202020202268747470223A207B0A2020202020202020202022736563726574223A2022746869732069732061207465737420666F722074686520736563726574220A20202020202020207D0A2020202020207D2C0A2020202020202266696C74657273223A207B0A2020202020202020226576656E745479706573223A207B0A2020202020202020202022696E636C756465223A205B22555345525F4144444544222C20225055424C49534845525F4641494C4544222C20225055424C49534845525F43524541544544222C20224D4F44454D5F5452414E534645525F4E4F545F5245434549564544222C20224D4F44454D5F4D4553534147455F5245434549564544222C20224D4F44454D5F5452414E534645525F52455455524E5F5452414E534645525F53544152544544222C20224C4F524157414E5F4D4F44454D535F44495341424C4544222C20224D4F44454D5F4D4553534147455F43414E4E4F545F42455F504152534544222C2022544F4B454E5F45585049524544222C20225055424C49534845525F55504441544544222C20224D4F44454D5F4C4F434154494F4E5F55504441544544222C20224D4F44454D5F434C41494D4544222C2022555345525F4143434553535F52455155455354222C20225055424C49534845525F44454C45544544222C20224D4F44454D5F5452414E534645525F53544152544544222C20224D4F44454D5F5354414C45222C20224D4F44454D5F5452414E534645525F5245434549564544222C20224D4F44454D5F5452414E534645525F43414E43454C4C4544222C2022555345525F52454D4F564544222C20224C4F524157414E5F4D4F44454D535F454E41424C4544222C20224D4F44454D5F4D4553534147455F53455155454E43455F534B4950222C20224D4F44454D5F4D4553534147455F44454C41594544222C20224C4F524157414E5F4D4553534147455F464F52574152445F4641494C4544222C20224F5247414E495A4154494F4E5F55504441544544222C20224C4F524157414E5F434F4E46494755524154494F4E5F55504441544544222C2022544F4B454E5F4558504952595F5741524E494E47222C2022544F4B454E5F43524541544544225D0A20202020202020207D2C0A2020202020202020226D6F64656D4E756D62657273223A207B0A20202020202020207D2C0A20202020202020202274616773223A207B0A20202020202020207D0A2020202020207D0A202020207D2C0A20202020227469746C65223A20225075626C6973686572203220686173206265656E20637265617465642E222C0A20202020226465736372697074696F6E223A2022436865636B20746865207075626C697368657273206C69737420666F722064657461696C73206F6E207075626C697368657220322E222C0A202020202274696D65223A207B0A2020202020202274696D657374616D70223A2022323031392D30352D31365431333A34363A34372E3136385A222C0A202020202020227465787475616C223A2022323031392D30352D31365431333A34363A34372E3136385A220A202020207D0A20207D0A7D

Received body (utf8):
{
  "publisherCreated": {
    "organization": "hiber",
    "created": {
      "id": "2",
      "description": "test webhook 2",
      "data": {
        "url": "http://localhost:8070",
        "contentType": "JSON",
        "http": {
          "secret": "this is a test for the secret"
        }
      },
      "filters": {
        "eventTypes": {
          "include": ["USER_ADDED", "PUBLISHER_FAILED", "PUBLISHER_CREATED", "MODEM_TRANSFER_NOT_RECEIVED", "MODEM_MESSAGE_RECEIVED", "MODEM_TRANSFER_RETURN_TRANSFER_STARTED", "LORAWAN_MODEMS_DISABLED", "MODEM_MESSAGE_CANNOT_BE_PARSED", "TOKEN_EXPIRED", "PUBLISHER_UPDATED", "MODEM_LOCATION_UPDATED", "MODEM_CLAIMED", "USER_ACCESS_REQUEST", "PUBLISHER_DELETED", "MODEM_TRANSFER_STARTED", "MODEM_STALE", "MODEM_TRANSFER_RECEIVED", "MODEM_TRANSFER_CANCELLED", "USER_REMOVED", "LORAWAN_MODEMS_ENABLED", "MODEM_MESSAGE_SEQUENCE_SKIP", "MODEM_MESSAGE_DELAYED", "LORAWAN_MESSAGE_FORWARD_FAILED", "ORGANIZATION_UPDATED", "LORAWAN_CONFIGURATION_UPDATED", "TOKEN_EXPIRY_WARNING", "TOKEN_CREATED"]
        },
        "modemNumbers": {
        },
        "tags": {
        }
      }
    },
    "title": "Publisher 2 has been created.",
    "description": "Check the publishers list for details on publisher 2.",
    "time": {
      "timestamp": "2019-05-16T13:46:47.168Z",
      "textual": "2019-05-16T13:46:47.168Z"
    }
  }
}


Expecting secret (utf8):
this is a test for the secret

Expecting secret (hex) (should be 746869732069732061207465737420666F722074686520736563726574):
746869732069732061207465737420666F722074686520736563726574


Received signature (hex):
8BDC5203BBDB019A0F3D71A670026FFF122A129B193851369A09360AE65DE6BF


Expecting signature (hex):
8BDC5203BBDB019A0F3D71A670026FFF122A129B193851369A09360AE65DE6BF
Signature is correct!

```
